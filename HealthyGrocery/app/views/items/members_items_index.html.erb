<!-- Author: Sameh Metias -->
<!-- Team: 3-->
<!-- This page is the view of the items from the members' point of view-->
<!-- The page does not correspond to the bootstrap we have settled on. It is jus an intermediate step for other developers to start working -->


<!-- Author: mina sedra -->
<!-- Team: 2 -->
   <%# body { background-image:url("http://freedesignfile.com/upload/2013/03/Fruits-and-vegetables-1.jpg");} %>
  
<html>
 
 <%= stylesheet_link_tag "items", :media => "all" %>
 <%= javascript_include_tag "items" %>

<head>

<%= include_gon %>

</head>

<% if current_member.records.count > 0 %>
<h1>Items as shown to members</h1>
</br>
</br>
<%#= (Item.all.where :status => true).count %>
<%#= Item.all.count %>

<body>
 
<!-- Title for the page -->

</br>
    <% if @warning.length > 0 %>
    <div class="alert alert-block">
      <%= @warning %>
    </div>
    <% end %>
    <div class="alert alert-info">
      <% if @items.count == 1 %>
      You've got 1 item.
      <% else %>
      You've got <%= @items.count %> items.
      <% end %>
      <%= @showing_pages %>
    </div>
    </br>
    <% if Item.all.count > 0 %>
    <navigationbar>
      <h5>Filter for products </h5>
      <% if @type_warning.length > 0 %>
      <div class="alert alert-error">
        <%= @type_warning %>
      </div>
      <% end %>
      <%#Author : Antoine Foti
        Team : 2
        Here is the filter search form where the user can fill any desired field and submit so that according to it the filter will be calculated. Also all the messages formed according to the filter search are displayed at the right moment. %>
      <%= form_tag '/items/members_items_index', :method => 'get' do %>
      <p>
        <span class="label label-important">Name :</span>
        <%= text_field_tag :name, params[:filter] %>
        </br></br>
        <span class="label label-important">Sort by :</span>
        <select name="sort_by">
          <%= @attributes = ["Name","Price","Category","Rating","Vitamin_A","Vitamin_B","Vitamin_C", "Vitamin_D", "Vitamin_E", "Vitamin_K", "Proteins", "Carbohydrate", "Calcium", "Fats"] %>
          <%= @attributes.each do |attribute| %>
          <option value= <%= attribute %> ><%= attribute %> </option>
          <% end %>
        </select>
        </br></br>
        <span class="label label-important">Items per page :</span>
        <select name="items_per_page">
          <%= @pages = ["5","10","15","20","25"] %>
          <%= @pages.each do |page| %>
          <option value= <%= page %> ><%= page %> </option>
          <% end %>
        </select>
        </br></br>
        <a href="#" onclick="toggle_visibility('foo');">Advanced search</a>
      <div id="foo" style="display:none">
        <span class="label label-info">Category :</span>
        <select name="category">
          <%= @categories = ["<None>"] %>
          <%= @categories += Item.distinct(:category) %>
          <%= @categories.each do |category| %>
          <option value= <%= category %> ><%= category %> </option>
          <% end %>
        </select>
        </br></br>
        <span class="label label-info">Price between:</span>
        <%= text_field_tag :price_from, params[:filter] %>
        </br>
        <span class="label label-info">And:</span>
        <%= text_field_tag :price_to, params[:filter] %>
        </br></br>
        <span class="label label-info">Rating between:</span>
        <%= text_field_tag :rating_from, params[:filter] %>
        </br>
        <span class="label label-info">And:</span>
        <%= text_field_tag :rating_to, params[:filter] %>
        </br></br>
        <% @items_extra_fields = ["Vitamin_A","Vitamin_B","Vitamin_C", "Vitamin_D", "Vitamin_E", "Vitamin_K", "Proteins", "Carbohydrate", "Calcium", "Fats"] %>
        <% @items_extra_fields.each do |extra_field| %>
        <span class="badge badge-info">Amount of <%= extra_field %>:</span>
        </br>
        <%= radio_button_tag extra_field, "High" %> <span class="">High</span>
        <%= radio_button_tag extra_field, "Medium" %> <span class="">Medium</span>
        <%= radio_button_tag extra_field, "Low" %> <span class="">Low</span>
        </br></br>
        <% end %>
        <%= radio_button_tag 'status', "all", :checked => true %> <span class="">All Products</span>
        </br>
        <%= radio_button_tag 'status', "available" %> <span class="">Available Only</span>
        </br></br>
      </div>
      <%= submit_tag "Search" %>
      </p>
      <% end %>
    </navigationbar>
    <% else %>
    <div class="alert alert-error">
      The retailer hasn't inserted any items yet.
    </div>
    <% end %>
    <% if @notification.length > 0 %>
    <div class="alert alert-success">
      <%= @notification %>
    </div>
    <% end %>
    <%= paginate @items %>

<% @items.each do |item| %>
  <icon>
    <img src= "<%= item.image%>" height=150 width=150 ></img></br>
    <td>Name: <%= item.name %></td> </br>
    <td>Price: <%= item.price %></td></br>
    <td>Category: <%= item.category %></td></br>
    <td>Stock: <%= item.amount %></td></br>
    <td>Available: <%= item.status %></td><br/>
    <td>Description: <%= item.description %></td></br>
    <td>Rating: <%= item.rating %></td></br>


    <textarea rows="1" cols="4"></textarea> KG  <button>Add to shopping cart</button></br>
    <%= button_to 'Add to wishlist', wishlines_path(item_id: item)%><!--add to wishlist/author:mohamed lotfy team:1-->

    <textarea rows="1" cols="4"></textarea> KG  <%= button_to 'Add to Cart', lineitems_path(item_id: item) %>
    </br>

    <td>Proteins: <%= item.protein %></td></br>
    <td>Carbohydrates: <%= item.carbohydrate %></td></br>
    <td>Calcium: <%= item.calcium %></td></br>
    <td>Fats: <%= item.fat %></td></br>
<!--AUTHOR: Mahmoud Eldesouky
    Team :5
    takes the quantiy from the user -->
<%= form_tag("members_items_index/add", method: "post", multipart: true) do %>
  <p>
    <%= hidden_field_tag(:item, item.id ) %>
    <%= text_field_tag :amount %>
    <%= submit_tag "Add to shopping cart", :name => nil %>
  </p>
 
<% end %>
    

  </icon>
<% end %>

<% end %>
    <!-- Author: mina sedra -->
<!-- Team: 2 -->

 <% if current_member.records.count == 0 %>
  <h2><p>PLEASE     ADD     YOUR    HEALTHRECORD FIRST </p></h2> 
                   <li><%= link_to "<button>My Healthrecords</button>".html_safe,indexhealthrecord_path(current_member)%></li>

<% end %>

</body>
<!--AUTHOR: Mahmoud Eldesouky
    Team :5
    parameter : message
    recieving the violation message as a parameter from items_controller and poping it to the user -->
<script type="text/javascript">
if (!gon.flag&&gon.message!=null){
alert(gon.message)
}
</script>

</html>
